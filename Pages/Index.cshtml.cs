using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading.Tasks;
using Microsoft.AspNetCore.Mvc;
using Microsoft.AspNetCore.Mvc.RazorPages;
using Microsoft.Extensions.Configuration;
using System.Net.Http;
using Microsoft.AspNetCore.Hosting;

namespace ruuvi_visualizer.Pages
{
    public class IndexModel : PageModel
    {
        private readonly IConfiguration _config;
        private readonly IHostingEnvironment _env;

        public string ApiKey { get; }
        public string TempDeviceId{ get; }

        public string Data { get; set; }

        public IndexModel(IConfiguration config, IHostingEnvironment env)
        {
            _config = config;
            _env = env;
            ApiKey = _config["Secrets:ApiKey"];
            TempDeviceId = _config["Secrets:TempDeviceId"];
        }

        static readonly HttpClient client = new HttpClient();

        public async Task<IActionResult> OnGetAsync(int? id)
        {
            if(id == null)
            {
                return Page();
            }

            if(_env.IsDevelopment())
            {
                // Sample data without http request in development mode
                Data = "[{\"dataFormat\":3,\"rssi\":-70,\"humidity\":37,\"temperature\":26.28,\"pressure\":100499,\"accelerationX\":17,\"accelerationY\":-31,\"accelerationZ\":1039,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T10:29:45.213Z\"},{\"dataFormat\":3,\"rssi\":-69,\"humidity\":36.5,\"temperature\":26.22,\"pressure\":100494,\"accelerationX\":19,\"accelerationY\":-34,\"accelerationZ\":1038,\"battery\":3121,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T10:44:56.739Z\"},{\"dataFormat\":3,\"rssi\":-75,\"humidity\":36.5,\"temperature\":26.2,\"pressure\":100490,\"accelerationX\":21,\"accelerationY\":-37,\"accelerationZ\":1035,\"battery\":3121,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T11:00:07.213Z\"},{\"dataFormat\":3,\"rssi\":-66,\"humidity\":36,\"temperature\":26.19,\"pressure\":100500,\"accelerationX\":16,\"accelerationY\":-35,\"accelerationZ\":1038,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T11:15:18.425Z\"},{\"dataFormat\":3,\"rssi\":-65,\"humidity\":36.5,\"temperature\":26.23,\"pressure\":100500,\"accelerationX\":20,\"accelerationY\":-34,\"accelerationZ\":1036,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T11:30:28.955Z\"},{\"dataFormat\":3,\"rssi\":-66,\"humidity\":36.5,\"temperature\":26.31,\"pressure\":100501,\"accelerationX\":23,\"accelerationY\":-32,\"accelerationZ\":1038,\"battery\":3109,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T11:45:40.174Z\"},{\"dataFormat\":3,\"rssi\":-66,\"humidity\":36.5,\"temperature\":26.34,\"pressure\":100497,\"accelerationX\":19,\"accelerationY\":-37,\"accelerationZ\":1038,\"battery\":3121,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T12:00:51.511Z\"},{\"dataFormat\":3,\"rssi\":-66,\"humidity\":36,\"temperature\":26.35,\"pressure\":100496,\"accelerationX\":16,\"accelerationY\":-35,\"accelerationZ\":1032,\"battery\":3109,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T12:16:02.756Z\"},{\"dataFormat\":3,\"rssi\":-69,\"humidity\":36,\"temperature\":26.33,\"pressure\":100484,\"accelerationX\":20,\"accelerationY\":-34,\"accelerationZ\":1035,\"battery\":3121,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T12:31:13.17Z\"},{\"dataFormat\":3,\"rssi\":-66,\"humidity\":35.5,\"temperature\":26.29,\"pressure\":100488,\"accelerationX\":21,\"accelerationY\":-32,\"accelerationZ\":1032,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T12:46:24.313Z\"},{\"dataFormat\":3,\"rssi\":-75,\"humidity\":36,\"temperature\":26.32,\"pressure\":100487,\"accelerationX\":20,\"accelerationY\":-34,\"accelerationZ\":1033,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T13:01:34.732Z\"},{\"dataFormat\":3,\"rssi\":-69,\"humidity\":36,\"temperature\":26.32,\"pressure\":100487,\"accelerationX\":23,\"accelerationY\":-29,\"accelerationZ\":1039,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T13:16:45.206Z\"},{\"dataFormat\":3,\"rssi\":-70,\"humidity\":36,\"temperature\":26.33,\"pressure\":100487,\"accelerationX\":20,\"accelerationY\":-35,\"accelerationZ\":1038,\"battery\":3109,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T13:31:56.595Z\"},{\"dataFormat\":3,\"rssi\":-75,\"humidity\":36,\"temperature\":26.36,\"pressure\":100496,\"accelerationX\":17,\"accelerationY\":-36,\"accelerationZ\":1030,\"battery\":3121,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T13:47:07.132Z\"},{\"dataFormat\":3,\"rssi\":-66,\"humidity\":36,\"temperature\":26.4,\"pressure\":100506,\"accelerationX\":22,\"accelerationY\":-32,\"accelerationZ\":1037,\"battery\":3121,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T14:02:17.605Z\"},{\"dataFormat\":3,\"rssi\":-70,\"humidity\":36,\"temperature\":26.41,\"pressure\":100505,\"accelerationX\":21,\"accelerationY\":-33,\"accelerationZ\":1038,\"battery\":3121,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T14:17:29.03Z\"},{\"dataFormat\":3,\"rssi\":-66,\"humidity\":35.5,\"temperature\":26.4,\"pressure\":100515,\"accelerationX\":22,\"accelerationY\":-33,\"accelerationZ\":1036,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T14:32:39.391Z\"},{\"dataFormat\":3,\"rssi\":-74,\"humidity\":35.5,\"temperature\":26.41,\"pressure\":100515,\"accelerationX\":20,\"accelerationY\":-32,\"accelerationZ\":1033,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T14:47:50.687Z\"},{\"dataFormat\":3,\"rssi\":-69,\"humidity\":35.5,\"temperature\":26.45,\"pressure\":100516,\"accelerationX\":21,\"accelerationY\":-32,\"accelerationZ\":1035,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T15:03:01.16Z\"},{\"dataFormat\":3,\"rssi\":-75,\"humidity\":35.5,\"temperature\":26.48,\"pressure\":100521,\"accelerationX\":20,\"accelerationY\":-35,\"accelerationZ\":1034,\"battery\":3121,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T15:18:12.438Z\"},{\"dataFormat\":3,\"rssi\":-75,\"humidity\":35.5,\"temperature\":26.5,\"pressure\":100523,\"accelerationX\":17,\"accelerationY\":-33,\"accelerationZ\":1032,\"battery\":3121,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T15:33:22.845Z\"},{\"dataFormat\":3,\"rssi\":-74,\"humidity\":35.5,\"temperature\":26.51,\"pressure\":100519,\"accelerationX\":17,\"accelerationY\":-34,\"accelerationZ\":1036,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T15:48:34.193Z\"},{\"dataFormat\":3,\"rssi\":-71,\"humidity\":35,\"temperature\":26.5,\"pressure\":100522,\"accelerationX\":24,\"accelerationY\":-31,\"accelerationZ\":1039,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T16:03:45.537Z\"},{\"dataFormat\":3,\"rssi\":-74,\"humidity\":35,\"temperature\":26.48,\"pressure\":100519,\"accelerationX\":20,\"accelerationY\":-34,\"accelerationZ\":1039,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T16:18:55.895Z\"},{\"dataFormat\":3,\"rssi\":-66,\"humidity\":34.5,\"temperature\":26.45,\"pressure\":100523,\"accelerationX\":22,\"accelerationY\":-31,\"accelerationZ\":1036,\"battery\":3121,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T16:34:06.321Z\"},{\"dataFormat\":3,\"rssi\":-75,\"humidity\":34.5,\"temperature\":26.42,\"pressure\":100518,\"accelerationX\":25,\"accelerationY\":-30,\"accelerationZ\":1032,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T16:49:17.541Z\"},{\"dataFormat\":3,\"rssi\":-66,\"humidity\":34.5,\"temperature\":26.41,\"pressure\":100533,\"accelerationX\":24,\"accelerationY\":-35,\"accelerationZ\":1038,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T17:04:28.06Z\"},{\"dataFormat\":3,\"rssi\":-66,\"humidity\":35.5,\"temperature\":26.42,\"pressure\":100548,\"accelerationX\":22,\"accelerationY\":-34,\"accelerationZ\":1035,\"battery\":3103,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T17:19:39.491Z\"},{\"dataFormat\":3,\"rssi\":-75,\"humidity\":36,\"temperature\":26.45,\"pressure\":100545,\"accelerationX\":18,\"accelerationY\":-33,\"accelerationZ\":1030,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T17:34:50.829Z\"},{\"dataFormat\":3,\"rssi\":-75,\"humidity\":36.5,\"temperature\":26.46,\"pressure\":100549,\"accelerationX\":24,\"accelerationY\":-33,\"accelerationZ\":1038,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T17:50:01.342Z\"},{\"dataFormat\":3,\"rssi\":-70,\"humidity\":36.5,\"temperature\":26.45,\"pressure\":100553,\"accelerationX\":21,\"accelerationY\":-31,\"accelerationZ\":1039,\"battery\":3121,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T18:05:12.645Z\"},{\"dataFormat\":3,\"rssi\":-70,\"humidity\":37,\"temperature\":26.44,\"pressure\":100554,\"accelerationX\":23,\"accelerationY\":-35,\"accelerationZ\":1036,\"battery\":3121,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T18:20:23.881Z\"},{\"dataFormat\":3,\"rssi\":-66,\"humidity\":37,\"temperature\":26.42,\"pressure\":100566,\"accelerationX\":22,\"accelerationY\":-33,\"accelerationZ\":1039,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T18:35:35.416Z\"},{\"dataFormat\":3,\"rssi\":-75,\"humidity\":37.5,\"temperature\":26.41,\"pressure\":100561,\"accelerationX\":15,\"accelerationY\":-34,\"accelerationZ\":1036,\"battery\":3121,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T18:50:45.854Z\"},{\"dataFormat\":3,\"rssi\":-75,\"humidity\":38,\"temperature\":26.39,\"pressure\":100573,\"accelerationX\":16,\"accelerationY\":-29,\"accelerationZ\":1035,\"battery\":3121,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T19:05:56.304Z\"},{\"dataFormat\":3,\"rssi\":-71,\"humidity\":38,\"temperature\":26.38,\"pressure\":100579,\"accelerationX\":18,\"accelerationY\":-32,\"accelerationZ\":1039,\"battery\":3103,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T19:21:07.598Z\"},{\"dataFormat\":3,\"rssi\":-50,\"humidity\":38,\"temperature\":26.43,\"pressure\":100581,\"accelerationX\":11,\"accelerationY\":-27,\"accelerationZ\":1036,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T19:36:18.027Z\"},{\"dataFormat\":3,\"rssi\":-59,\"humidity\":38.5,\"temperature\":26.44,\"pressure\":100591,\"accelerationX\":19,\"accelerationY\":-28,\"accelerationZ\":1038,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T19:51:28.502Z\"},{\"dataFormat\":3,\"rssi\":-50,\"humidity\":38.5,\"temperature\":26.48,\"pressure\":100597,\"accelerationX\":18,\"accelerationY\":-26,\"accelerationZ\":1035,\"battery\":3121,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T20:06:39.802Z\"},{\"dataFormat\":3,\"rssi\":-50,\"humidity\":38.5,\"temperature\":26.48,\"pressure\":100601,\"accelerationX\":19,\"accelerationY\":-27,\"accelerationZ\":1039,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T20:21:52.097Z\"},{\"dataFormat\":3,\"rssi\":-49,\"humidity\":39,\"temperature\":26.47,\"pressure\":100610,\"accelerationX\":15,\"accelerationY\":-28,\"accelerationZ\":1038,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T20:37:02.506Z\"},{\"dataFormat\":3,\"rssi\":-60,\"humidity\":39.5,\"temperature\":26.5,\"pressure\":100615,\"accelerationX\":20,\"accelerationY\":-25,\"accelerationZ\":1038,\"battery\":3109,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T20:52:13.9Z\"},{\"dataFormat\":3,\"rssi\":-49,\"humidity\":39.5,\"temperature\":26.51,\"pressure\":100613,\"accelerationX\":18,\"accelerationY\":-28,\"accelerationZ\":1033,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T21:07:24.354Z\"},{\"dataFormat\":3,\"rssi\":-49,\"humidity\":39.5,\"temperature\":26.52,\"pressure\":100629,\"accelerationX\":14,\"accelerationY\":-27,\"accelerationZ\":1033,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T21:22:34.733Z\"},{\"dataFormat\":3,\"rssi\":-49,\"humidity\":39,\"temperature\":26.48,\"pressure\":100636,\"accelerationX\":19,\"accelerationY\":-23,\"accelerationZ\":1038,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T21:37:46.078Z\"},{\"dataFormat\":3,\"rssi\":-60,\"humidity\":39.5,\"temperature\":26.48,\"pressure\":100642,\"accelerationX\":16,\"accelerationY\":-25,\"accelerationZ\":1031,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T21:52:57.432Z\"},{\"dataFormat\":3,\"rssi\":-60,\"humidity\":39.5,\"temperature\":26.49,\"pressure\":100654,\"accelerationX\":18,\"accelerationY\":-26,\"accelerationZ\":1038,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T22:08:08.76Z\"},{\"dataFormat\":3,\"rssi\":-49,\"humidity\":39.5,\"temperature\":26.48,\"pressure\":100660,\"accelerationX\":15,\"accelerationY\":-27,\"accelerationZ\":1033,\"battery\":3109,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T22:23:19.231Z\"},{\"dataFormat\":3,\"rssi\":-59,\"humidity\":39.5,\"temperature\":26.46,\"pressure\":100666,\"accelerationX\":17,\"accelerationY\":-23,\"accelerationZ\":1034,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T22:38:29.628Z\"},{\"dataFormat\":3,\"rssi\":-49,\"humidity\":39,\"temperature\":26.44,\"pressure\":100665,\"accelerationX\":15,\"accelerationY\":-27,\"accelerationZ\":1039,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T22:53:40.879Z\"},{\"dataFormat\":3,\"rssi\":-50,\"humidity\":39,\"temperature\":26.38,\"pressure\":100676,\"accelerationX\":18,\"accelerationY\":-27,\"accelerationZ\":1031,\"battery\":3109,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T23:08:52.287Z\"},{\"dataFormat\":3,\"rssi\":-50,\"humidity\":39,\"temperature\":26.38,\"pressure\":100691,\"accelerationX\":17,\"accelerationY\":-27,\"accelerationZ\":1037,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T23:24:02.771Z\"},{\"dataFormat\":3,\"rssi\":-50,\"humidity\":39,\"temperature\":26.4,\"pressure\":100697,\"accelerationX\":15,\"accelerationY\":-31,\"accelerationZ\":1037,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T23:39:14.066Z\"},{\"dataFormat\":3,\"rssi\":-48,\"humidity\":39.5,\"temperature\":26.4,\"pressure\":100708,\"accelerationX\":19,\"accelerationY\":-26,\"accelerationZ\":1035,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-19T23:54:24.494Z\"},{\"dataFormat\":3,\"rssi\":-50,\"humidity\":39.5,\"temperature\":26.42,\"pressure\":100719,\"accelerationX\":18,\"accelerationY\":-27,\"accelerationZ\":1035,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T00:09:35.856Z\"},{\"dataFormat\":3,\"rssi\":-49,\"humidity\":39.5,\"temperature\":26.42,\"pressure\":100726,\"accelerationX\":19,\"accelerationY\":-27,\"accelerationZ\":1034,\"battery\":3121,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T00:24:46.323Z\"},{\"dataFormat\":3,\"rssi\":-60,\"humidity\":39,\"temperature\":26.42,\"pressure\":100731,\"accelerationX\":14,\"accelerationY\":-31,\"accelerationZ\":1038,\"battery\":3121,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T00:39:57.646Z\"},{\"dataFormat\":3,\"rssi\":-49,\"humidity\":39,\"temperature\":26.4,\"pressure\":100735,\"accelerationX\":17,\"accelerationY\":-29,\"accelerationZ\":1035,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T00:55:08.267Z\"},{\"dataFormat\":3,\"rssi\":-60,\"humidity\":39,\"temperature\":26.38,\"pressure\":100738,\"accelerationX\":16,\"accelerationY\":-28,\"accelerationZ\":1037,\"battery\":3121,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T01:10:18.721Z\"},{\"dataFormat\":3,\"rssi\":-60,\"humidity\":39,\"temperature\":26.38,\"pressure\":100733,\"accelerationX\":18,\"accelerationY\":-25,\"accelerationZ\":1037,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T01:25:30.238Z\"},{\"dataFormat\":3,\"rssi\":-49,\"humidity\":39,\"temperature\":26.38,\"pressure\":100745,\"accelerationX\":17,\"accelerationY\":-29,\"accelerationZ\":1038,\"battery\":3109,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T01:40:41.747Z\"},{\"dataFormat\":3,\"rssi\":-49,\"humidity\":39,\"temperature\":26.38,\"pressure\":100746,\"accelerationX\":15,\"accelerationY\":-30,\"accelerationZ\":1039,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T01:55:53.952Z\"},{\"dataFormat\":3,\"rssi\":-49,\"humidity\":39,\"temperature\":26.37,\"pressure\":100758,\"accelerationX\":15,\"accelerationY\":-25,\"accelerationZ\":1039,\"battery\":3103,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T02:11:05.232Z\"},{\"dataFormat\":3,\"rssi\":-49,\"humidity\":39,\"temperature\":26.38,\"pressure\":100771,\"accelerationX\":13,\"accelerationY\":-27,\"accelerationZ\":1038,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T02:26:15.739Z\"},{\"dataFormat\":3,\"rssi\":-49,\"humidity\":39,\"temperature\":26.37,\"pressure\":100785,\"accelerationX\":21,\"accelerationY\":-27,\"accelerationZ\":1039,\"battery\":3121,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T02:41:28.027Z\"},{\"dataFormat\":3,\"rssi\":-49,\"humidity\":39,\"temperature\":26.39,\"pressure\":100791,\"accelerationX\":14,\"accelerationY\":-26,\"accelerationZ\":1033,\"battery\":3121,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T02:56:39.362Z\"},{\"dataFormat\":3,\"rssi\":-60,\"humidity\":38.5,\"temperature\":26.42,\"pressure\":100796,\"accelerationX\":21,\"accelerationY\":-24,\"accelerationZ\":1032,\"battery\":3121,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T03:11:49.764Z\"},{\"dataFormat\":3,\"rssi\":-60,\"humidity\":38.5,\"temperature\":26.46,\"pressure\":100805,\"accelerationX\":21,\"accelerationY\":-29,\"accelerationZ\":1036,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T03:27:07.404Z\"},{\"dataFormat\":3,\"rssi\":-50,\"humidity\":38,\"temperature\":26.52,\"pressure\":100804,\"accelerationX\":21,\"accelerationY\":-29,\"accelerationZ\":1034,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T03:42:21.46Z\"},{\"dataFormat\":3,\"rssi\":-60,\"humidity\":38,\"temperature\":26.57,\"pressure\":100812,\"accelerationX\":14,\"accelerationY\":-27,\"accelerationZ\":1039,\"battery\":3103,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T03:57:32.616Z\"},{\"dataFormat\":3,\"rssi\":-60,\"humidity\":38,\"temperature\":26.62,\"pressure\":100807,\"accelerationX\":19,\"accelerationY\":-26,\"accelerationZ\":1035,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T04:12:43.061Z\"},{\"dataFormat\":3,\"rssi\":-60,\"humidity\":38,\"temperature\":26.67,\"pressure\":100813,\"accelerationX\":19,\"accelerationY\":-27,\"accelerationZ\":1043,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T04:27:55.333Z\"},{\"dataFormat\":3,\"rssi\":-49,\"humidity\":38,\"temperature\":26.73,\"pressure\":100822,\"accelerationX\":19,\"accelerationY\":-30,\"accelerationZ\":1039,\"battery\":3121,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T04:43:07.697Z\"},{\"dataFormat\":3,\"rssi\":-50,\"humidity\":37.5,\"temperature\":26.78,\"pressure\":100832,\"accelerationX\":18,\"accelerationY\":-30,\"accelerationZ\":1040,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T04:58:19.022Z\"},{\"dataFormat\":3,\"rssi\":-50,\"humidity\":37.5,\"temperature\":26.82,\"pressure\":100841,\"accelerationX\":13,\"accelerationY\":-26,\"accelerationZ\":1036,\"battery\":3121,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T05:13:30.351Z\"},{\"dataFormat\":3,\"rssi\":-60,\"humidity\":37.5,\"temperature\":26.87,\"pressure\":100857,\"accelerationX\":19,\"accelerationY\":-25,\"accelerationZ\":1037,\"battery\":3121,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T05:28:40.818Z\"},{\"dataFormat\":3,\"rssi\":-60,\"humidity\":37.5,\"temperature\":26.87,\"pressure\":100871,\"accelerationX\":17,\"accelerationY\":-26,\"accelerationZ\":1034,\"battery\":3127,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T05:43:51.225Z\"},{\"dataFormat\":3,\"rssi\":-49,\"humidity\":37.5,\"temperature\":26.87,\"pressure\":100879,\"accelerationX\":18,\"accelerationY\":-25,\"accelerationZ\":1037,\"battery\":3121,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T05:59:02.497Z\"},{\"dataFormat\":3,\"rssi\":-50,\"humidity\":37,\"temperature\":26.87,\"pressure\":100885,\"accelerationX\":19,\"accelerationY\":-26,\"accelerationZ\":1032,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T06:14:13.807Z\"},{\"dataFormat\":3,\"rssi\":-50,\"humidity\":37.5,\"temperature\":26.89,\"pressure\":100889,\"accelerationX\":17,\"accelerationY\":-27,\"accelerationZ\":1031,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T06:29:25.156Z\"},{\"dataFormat\":3,\"rssi\":-50,\"humidity\":37,\"temperature\":26.88,\"pressure\":100892,\"accelerationX\":18,\"accelerationY\":-31,\"accelerationZ\":1034,\"battery\":3121,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T06:44:35.724Z\"},{\"dataFormat\":3,\"rssi\":-49,\"humidity\":37,\"temperature\":26.84,\"pressure\":100898,\"accelerationX\":15,\"accelerationY\":-26,\"accelerationZ\":1036,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T06:59:47.026Z\"},{\"dataFormat\":3,\"rssi\":-50,\"humidity\":37,\"temperature\":26.79,\"pressure\":100904,\"accelerationX\":18,\"accelerationY\":-29,\"accelerationZ\":1036,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T07:14:58.25Z\"},{\"dataFormat\":3,\"rssi\":-49,\"humidity\":37,\"temperature\":26.75,\"pressure\":100904,\"accelerationX\":20,\"accelerationY\":-28,\"accelerationZ\":1038,\"battery\":3121,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T07:30:09.658Z\"},{\"dataFormat\":3,\"rssi\":-60,\"humidity\":37,\"temperature\":26.73,\"pressure\":100910,\"accelerationX\":23,\"accelerationY\":-27,\"accelerationZ\":1039,\"battery\":3121,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T07:45:20.158Z\"},{\"dataFormat\":3,\"rssi\":-50,\"humidity\":37,\"temperature\":26.77,\"pressure\":100914,\"accelerationX\":12,\"accelerationY\":-28,\"accelerationZ\":1034,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T08:00:30.646Z\"},{\"dataFormat\":3,\"rssi\":-50,\"humidity\":37,\"temperature\":26.88,\"pressure\":100917,\"accelerationX\":14,\"accelerationY\":-27,\"accelerationZ\":1037,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T08:15:41.989Z\"},{\"dataFormat\":3,\"rssi\":-59,\"humidity\":36,\"temperature\":26.9,\"pressure\":100914,\"accelerationX\":18,\"accelerationY\":-28,\"accelerationZ\":1035,\"battery\":3109,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T08:30:53.309Z\"},{\"dataFormat\":3,\"rssi\":-50,\"humidity\":36,\"temperature\":26.89,\"pressure\":100927,\"accelerationX\":21,\"accelerationY\":-30,\"accelerationZ\":1038,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T08:46:04.665Z\"},{\"dataFormat\":3,\"rssi\":-60,\"humidity\":35.5,\"temperature\":26.85,\"pressure\":100937,\"accelerationX\":21,\"accelerationY\":-27,\"accelerationZ\":1039,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T09:01:16.088Z\"},{\"dataFormat\":3,\"rssi\":-50,\"humidity\":35,\"temperature\":26.78,\"pressure\":100946,\"accelerationX\":20,\"accelerationY\":-25,\"accelerationZ\":1034,\"battery\":3109,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T09:16:26.611Z\"},{\"dataFormat\":3,\"rssi\":-50,\"humidity\":34.5,\"temperature\":26.73,\"pressure\":100950,\"accelerationX\":18,\"accelerationY\":-24,\"accelerationZ\":1035,\"battery\":3121,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T09:31:37.111Z\"},{\"dataFormat\":3,\"rssi\":-60,\"humidity\":34,\"temperature\":26.7,\"pressure\":100962,\"accelerationX\":20,\"accelerationY\":-25,\"accelerationZ\":1040,\"battery\":3121,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T09:46:47.487Z\"},{\"dataFormat\":3,\"rssi\":-50,\"humidity\":33.5,\"temperature\":26.7,\"pressure\":100963,\"accelerationX\":22,\"accelerationY\":-27,\"accelerationZ\":1035,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T10:01:57.844Z\"},{\"dataFormat\":3,\"rssi\":-50,\"humidity\":33.5,\"temperature\":26.73,\"pressure\":100978,\"accelerationX\":18,\"accelerationY\":-27,\"accelerationZ\":1040,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T10:17:09.106Z\"},{\"dataFormat\":3,\"rssi\":-60,\"humidity\":35.5,\"temperature\":26.81,\"pressure\":100980,\"accelerationX\":19,\"accelerationY\":-24,\"accelerationZ\":1040,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T10:32:20.5Z\"},{\"dataFormat\":3,\"rssi\":-60,\"humidity\":38,\"temperature\":27.06,\"pressure\":100982,\"accelerationX\":19,\"accelerationY\":-26,\"accelerationZ\":1036,\"battery\":3109,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T10:47:30.955Z\"},{\"dataFormat\":3,\"rssi\":-49,\"humidity\":39.5,\"temperature\":27.2,\"pressure\":100992,\"accelerationX\":16,\"accelerationY\":-29,\"accelerationZ\":1039,\"battery\":3121,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T11:02:42.289Z\"},{\"dataFormat\":3,\"rssi\":-50,\"humidity\":41,\"temperature\":27.28,\"pressure\":101001,\"accelerationX\":18,\"accelerationY\":-30,\"accelerationZ\":1037,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T11:17:52.751Z\"},{\"dataFormat\":3,\"rssi\":-49,\"humidity\":42,\"temperature\":27.33,\"pressure\":101005,\"accelerationX\":19,\"accelerationY\":-28,\"accelerationZ\":1038,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T11:33:04.051Z\"},{\"dataFormat\":3,\"rssi\":-50,\"humidity\":42.5,\"temperature\":27.36,\"pressure\":101009,\"accelerationX\":17,\"accelerationY\":-25,\"accelerationZ\":1035,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T11:48:14.422Z\"},{\"dataFormat\":3,\"rssi\":-49,\"humidity\":43,\"temperature\":27.37,\"pressure\":101018,\"accelerationX\":13,\"accelerationY\":-26,\"accelerationZ\":1038,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T12:03:24.926Z\"},{\"dataFormat\":3,\"rssi\":-59,\"humidity\":43.5,\"temperature\":27.38,\"pressure\":101018,\"accelerationX\":20,\"accelerationY\":-29,\"accelerationZ\":1038,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T12:18:35.422Z\"},{\"dataFormat\":3,\"rssi\":-49,\"humidity\":43,\"temperature\":27.37,\"pressure\":101016,\"accelerationX\":17,\"accelerationY\":-30,\"accelerationZ\":1034,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T12:33:45.777Z\"},{\"dataFormat\":3,\"rssi\":-50,\"humidity\":41.5,\"temperature\":27.31,\"pressure\":101017,\"accelerationX\":17,\"accelerationY\":-29,\"accelerationZ\":1032,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T12:48:56.263Z\"},{\"dataFormat\":3,\"rssi\":-50,\"humidity\":40,\"temperature\":27.22,\"pressure\":101012,\"accelerationX\":17,\"accelerationY\":-27,\"accelerationZ\":1037,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T13:04:06.691Z\"},{\"dataFormat\":3,\"rssi\":-49,\"humidity\":40.5,\"temperature\":27.17,\"pressure\":101012,\"accelerationX\":16,\"accelerationY\":-27,\"accelerationZ\":1034,\"battery\":3121,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T13:19:18.117Z\"},{\"dataFormat\":3,\"rssi\":-50,\"humidity\":40.5,\"temperature\":27.14,\"pressure\":101022,\"accelerationX\":13,\"accelerationY\":-26,\"accelerationZ\":1034,\"battery\":3115,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T13:34:29.648Z\"},{\"dataFormat\":3,\"rssi\":-50,\"humidity\":38.5,\"temperature\":26.9,\"pressure\":101016,\"accelerationX\":17,\"accelerationY\":-28,\"accelerationZ\":1036,\"battery\":3121,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T13:49:40.103Z\"},{\"dataFormat\":3,\"rssi\":-59,\"humidity\":38.5,\"temperature\":26.74,\"pressure\":101012,\"accelerationX\":14,\"accelerationY\":-32,\"accelerationZ\":1039,\"battery\":3121,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T14:04:50.542Z\"},{\"dataFormat\":3,\"rssi\":-59,\"humidity\":39,\"temperature\":26.79,\"pressure\":101004,\"accelerationX\":17,\"accelerationY\":-28,\"accelerationZ\":1038,\"battery\":3121,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T14:20:01.88Z\"},{\"dataFormat\":3,\"rssi\":-50,\"humidity\":39.5,\"temperature\":26.89,\"pressure\":101008,\"accelerationX\":19,\"accelerationY\":-24,\"accelerationZ\":1034,\"battery\":3121,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T14:35:13.208Z\"},{\"dataFormat\":3,\"rssi\":-50,\"humidity\":39.5,\"temperature\":26.93,\"pressure\":101009,\"accelerationX\":16,\"accelerationY\":-24,\"accelerationZ\":1034,\"battery\":3121,\"id\":\"simulator001\",\"timestamp\":\"2019-07-20T14:50:23.698Z\"}]";
            }
            else
            {
                try
                {
                    HttpResponseMessage response = await client.GetAsync($"https://ruuvi-collector-func2.azurewebsites.net/api/HttpTriggerCSharp/id/{TempDeviceId}?code={ApiKey}");
                    response.EnsureSuccessStatusCode();
                    string responseBody = await response.Content.ReadAsStringAsync();
                    // Above three lines can be replaced with new helper method below
                    // string responseBody = await client.GetStringAsync(uri);

                    Data = responseBody;
                }  
                catch(HttpRequestException e)
                {
                    Console.WriteLine("\nException Caught!");	
                    Console.WriteLine("Message :{0} ",e.Message);
                }
            }

            return Page();
        }
    }
}
